CREATE TABLE CUSTOMER1(CUST_ID INT PRIMARY KEY,
                        CUST_NAME VARCHAR(20),
                        CUST_CITY VARCHAR(20),
                        CUST_STATE VARCHAR(5),
                        CUST_DOB DATE,
                        CUST_GENDER VARCHAR(5)
                        )
                 
SELECT SYSDATE FROM DUAL
                
INSERT INTO CUSTOMER1 VALUES  (100,'TIM','CHENNAI','TN','22-FEB-2000','M')
INSERT INTO CUSTOMER1 VALUES  (101,'BILL','BANGALORE','KA','4-JAN-2000','M')
INSERT INTO CUSTOMER1 VALUES  (102,'RAVI','CHENNAI','TN','','M')
INSERT INTO CUSTOMER1 VALUES  (103,'PALLAVI','BANGALORE','KA','10-APR-2000','F')
INSERT INTO CUSTOMER1 VALUES  (104,'PRITHVI','MUMBAI','MH','18-OCT-1997','M')

SELECT * FROM CUSTOMER1

CREATE TABLE EMPLOYEE1(EMP_ID INT PRIMARY KEY,
                        EMP_NAME VARCHAR(20),
                        EMP_DOJ DATE,
                        EMP_CITY VARCHAR(20),
                        EMP_STATE VARCHAR(5),
                        MGR_ID INT
                        )
                        
INSERT INTO EMPLOYEE1 VALUES(3400,'SUMA','10-JAN-09','BANGALORE','KA',3401)
INSERT INTO EMPLOYEE1 VALUES(3401,'SURAJ','12-APR-13','BANGALORE','KA',NULL)
INSERT INTO EMPLOYEE1 VALUES(3402,'RAJESH','11-MAY-18','CHENNAI','TN',3401)
INSERT INTO EMPLOYEE1 VALUES(3403,'ADITYA','10-JAN-2019','CHENNAI','TN',NULL)
INSERT INTO EMPLOYEE1 VALUES(3404,'RAGHAVAN','10-JAN-09','BANGALORE','KA',3403)
INSERT INTO EMPLOYEE1 VALUES(3405,'VISHWANATH','10-JAN-09','MUMBAI','MH',3403)
INSERT INTO EMPLOYEE1 VALUES(3406,'DHRUV','10-JAN-09','MUMBAI','MH',3403)

SELECT * FROM EMPLOYEE1

CREATE TABLE INQUIRY (INQ_ID INT PRIMARY KEY,
                    INQ_DATE DATE,
                    INQ_TYPE VARCHAR(20),
                    INQ_ABOUT VARCHAR(20),
                    EMP_ID INT,FOREIGN KEY(EMP_ID) REFERENCES EMPLOYEE1(EMP_ID), 
                    CUST_ID INT,FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER1(CUST_ID)
                    )
                    
DROP TABLE INQUIRY
                    
                    
INSERT INTO INQUIRY VALUES(1,'25-AUG-21','INTERNET','NEW CONNECTION',3406,NULL)
INSERT INTO INQUIRY VALUES(2,'25-AUG-21','VOICE','UPGRADE',3406,101)
INSERT INTO INQUIRY VALUES(3,'14-AUG-21','INTERNET','DATA UPGRADE',3400,102)
INSERT INTO INQUIRY VALUES(4,'15-AUG-21','INTERNET','LINE DOWN',3400,102)
INSERT INTO INQUIRY VALUES(5,'20-AUG-21','INTERNET','NEW CONNECTION',3406,NULL)
INSERT INTO INQUIRY VALUES(6,'21-AUG-21','INTERNET','LINE DOWN',3400,103)
INSERT INTO INQUIRY VALUES(7,'22-AUG-21','VOICE','DATA UPGRADE',3404,102)

SELECT * FROM INQUIRY
DESC INQUIRY

COMMIT

---FIND EMPLOYEES WHO ARE NOT REPLITING TO ANY MANAGER
SELECT EMP_NAME
FROM EMPLOYEE1
WHERE MGR_ID IS NULL

---DISPLAY CUST_STATE WISE NUMBER OF CUSTOMERS
SELECT CUST_STATE,COUNT(CUST_ID)
FROM CUSTOMER1
GROUP BY CUST_STATE

--- Display the number of inquiries we got in the year of 2021
---DISPLAY THE NUMBER OF INQUIRIES WE GOT IN THE YEAR OF 2021
SELECT  COUNT(INQ_ID)
FROM INQUIRY
WHERE TO_CHAR(INQ_DATE,'YYYY')=2021

SELECT COUNT(INQ_ID)
FROM INQUIRY
WHERE INQ_DATE IN BETWEEN '01-JAN-21' TO '31-DEC-21'

---FIND THE CUSTOMER WHO IS FROM THE CITY AS CUSTOMER RAVI
SELECT CUST_NAME
FROM CUSTOMER1
WHERE CUST_CITY = (SELECT CUST_CITY 
                    FROM CUSTOMER1
                    WHERE CUST_NAME = 'RAVI')
                    
---FIND THE INQUIRY TYPE AND THE NUMBER OF INQURIES WE GOT IN EACH TYPE
SELECT INQ_ABOUT,COUNT(INQ_ID)
FROM INQUIRY
GROUP BY INQ_ABOUT

---DISPLAY EMP_NAME,MONTH OF EXPERIENCE OF THE EMPLOYEE .CONSIDER EMPLOYEES ONLY FROM STATE OF KA OR MH
SELECT EMP_NAME, MONTHS_BETWEEN (SYSDATE,EMP_DOJ) 
FROM EMPLOYEE1 
WHERE EMP_STATE ='KA' OR EMP_STATE = 'MH'

---DISPLAY INQUIRY ID AND MORE INQUIRY
SELECT EMP_CITY,COUNT(EMP_STATE)
FROM EMPLOYEE1
GROUP BY EMP_CITY

---DISPLAY CUSTOMER ID AND NAME ONLY FEMALE CUSTOMER IN TABLE
SELECT CUST_ID,CUST_NAME
FROM CUSTOMER1
WHERE CUST_GENDER ='F'

---LIST THE CUST_ID WHO RISE THE INQUIRY TYPE IS INTERNET
select count(CUSTOMER1.CUST_id)
from CUSTOMER1 INNER JOIN INQUIRY
ON CUSTOMER1.CUST_ID = INQUIRY.CUST_ID
WHERE INQ_TYPE='INTERNET'